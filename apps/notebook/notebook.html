<!DOCTYPE html>
<!--[if lt IE 7]> <html class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>    <html class="lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>    <html class="lt-ie9"> <![endif]-->
<!--[if IE 9]>    <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!--> <html> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>

    <!-- Import JQuery library -->
    <script src="http://%SYSIP%:8001/lib/jquery/jquery-1.11.1.min.js"></script>

    <!-- Import Foundation Frameworks -->
    <script src="http://%SYSIP%:8001/lib/framework/foundation/foundation.js"></script>

    <!-- Import UI Frameworks -->
    <script src="http://%SYSIP%:8001/lib/framework/ui/ui-kits.js"></script>

    <!-- Import Font Awesome -->
    <link href="http://%SYSIP%:8001/lib/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Import 3rd party frameworks -->
    <script src="lib/ckeditor/ckeditor.js"></script>
    <script src="lib/jqTree/tree.jquery.js"></script>

    <!-- Import note style -->
    <link href="lib/jqTree/jqtree.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet"></script>

    <script>
        /* NotebookViewController Constructor */
        function NotebookViewController() {
            this._super = CoreClient;
            this.delegate = this;
        };

        /* Inherit CoreClient */
        NotebookViewController.prototype = new CoreClient();
        NotebookViewController.prototype.constructor = NotebookViewController;

        $(function() {
            var notebookViewController = new NotebookViewController();
            notebookViewController.initiate();

            resizeContent();

            $('#accordion').accordion({
                heightStyle: "fill",
                collapsible: true,
                active: 1
            });
        });

        $(window).resize(function() {
            resizeContent();
        });
    </script>
</head>
<body>
    <div id="wrapper">
        <div id="header"></div>
        <div id="content">
            <div id="control-bar"><p>Control Bar</p></div>
            <div id="container">
                <div id="bookshelf">
                    <div id="accordion">
                        <h3>Bookmarks</h3>
                        <div id="bookmark-list">
                            <ul>
                                <li>
                                    <i class="fa fa-bookmark-o"></i>
                                    <span>Bookmark 1</span>
                                </li>
                            </ul>
                        </div>

                        <h3>Notebooks</h3>
                        <div id="notebook-stack"></div>
                    </div>
                </div>
                <div id="notes">
                    <ul>
                        <li>Home</li>
                        <li>About</li>
                        <li>Projects</li>
                        <li>Blog</li>
                        <li>Home</li>
                        <li>About</li>
                        <li>Projects</li>
                        <li>Blog</li>
                        <li>Home</li>
                        <li>About</li>
                        <li>Projects</li>
                        <li>Blog</li>
                        <li>Home</li>
                        <li>About</li>
                        <li>Projects</li>
                        <li>Blog</li>
                        <li>Home</li>
                        <li>About</li>
                        <li>Projects</li>
                        <li>Blog</li>
                        <li>Home</li>
                        <li>About</li>
                        <li>Projects</li>
                        <li>Blog</li>
                    </ul>
                </div>
                <div id="note-content">
                    <textarea id="noteEditor" name="noteEditor">
                        <h1><u><em><strong>Hello Chardi &amp; Bowie!</strong></em></u></h1>
                    </textarea>
                </div>
            </div>
        <div id="footer"></div>
    </div>

    <script>
        function resizeContent() {
            var newWidth = $("html").width();
            var newHeight = $("html").height() - $("#header").height() - $("#control-bar").height() - $("#footer").height();
            $("#bookshelf").css("width", newWidth * 0.15 + "px");
            $("#bookshelf").css("height", newHeight + "px");
            $("#notes").css("width", newWidth * 0.2 + "px");
            $("#notes").css("height", newHeight + "px");
            $("#note-content").css("height", newHeight + "px");
            try {
                CKEDITOR.instances['noteEditor'].resize("100%", newHeight);
            } catch (e) {}
        }

        var page = new Page();
        page.setTitle("Notebook");
        page.createNavigationBar("Notebook");
        page.setFooterText("%COPYRIGHT%");

        var brandLabel = new NavigationBarLabel("%BRAND%");
        page.navigationBar.rightContainer.pushItem(brandLabel);

        CKEDITOR.replace("noteEditor", { "extraPlugins": "customsave" });
        CKEDITOR.config.resize_enabled = false;
        CKEDITOR.config.removePlugins = 'elementspath, about';

        CKEDITOR.on("instanceReady", function(event) {
            resizeContent();
        });

        CKEDITOR.instances['noteEditor'].on("customsave", function() {
            var value = CKEDITOR.instances['noteEditor'].getData();
            alert(value);
        });

        CKEDITOR.instances['noteEditor'].on("maximize", function(state) {
            if (state.data === CKEDITOR.TRISTATE_ON)
                page.navigationBar.hide();
            else
                page.navigationBar.show();
        });

        /* Initialize bookshelf */
        var data = [
            {
                label: 'Notebook Stack 1',
                children: [
                    { label: 'Notebook 1' },
                    { label: 'Notebook 2' }
                ]
            },
            {
                label: 'Notebook Stack 2',
                children: [
                    { label: 'Notebook 3' }
                ]
            },
            {
                label: 'Notebook 4',
            }
        ];

        $('#notebook-stack').tree({
            closedIcon: $('<i class="fa fa-caret-right"></i>'),
            openedIcon: $('<i class="fa fa-caret-down"></i>'),
            folderIcon: $('<i class="fa fa-list"></i>'),
            nodeIcon: $('<i class="fa fa-book"></i>'),
            toggleable: false,
            dragAndDrop: true,
            autoOpen: 0,
            data: data
        });

        /* Initialize note list */
        var selectedNoteIndex = -1;
        $("#notes li").click(function() {
            if (!$(this).hasClass("selected")) {
                if (selectedNoteIndex >= 0)
                    $("#notes li").eq(selectedNoteIndex).removeClass("selected");
                selectedNoteIndex = $("#notes li").index($(this));
                $(this).addClass("selected");
            }
        });
    </script>
</body>
</html>
